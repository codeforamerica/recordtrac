{% block custom_css_links %}
<!-- used for the extension and close request multi-select boxes in city view -->
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/manage_request_city_less_js.css') }}">
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/sidebar.css') }}">
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/bottom_sidebar.css') }}">
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/case.css') }}">
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/plugins/bootstrap-select.css') }}">
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/plugins/jasny-bootstrap.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/jquery.fileupload.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/jquery.fileupload-ui.css') }}">
{% endblock custom_css_links %}
{% if current_user.is_authenticated %}
<div class="row-fluid">
    <div class="span12">
        <ul class="nav nav-pills" role="tablist">
            <li><a href="#add_record" role="tab" data-toggle="tab">
                <small>Add Record</small>
            </a></li>
        </ul>
    </div>
</div>
<div class="row-fluid">
    <div class="tab-content">
        <div class="tab-pane" id="add_record">
            <form name="input_doc" style="margin-top: 2em;" id="submitRecord"
                  method="post"
                  action="/add_a_record_and_close" autocomplete="on"
                  enctype="multipart/form-data">
                <input type="hidden" name="audience" value="city"/>
                <input name=_csrf_token type=hidden value="{{ csrf_token() }}">
                {% if "missing_record_description" in errors %}
                    <div class="alert alert-danger" id="missing_record_description">
                        {{ errors['missing_record_description'] }}</div>
                {% endif %}
                {% if "missing_record_access" in errors %}
                    <div class="alert alert-danger"
                         id="missing_record_access">{{ errors['missing_record_access'] }}</div>
                {% endif %}
                {% if "file_too_large" in errors %}
                    <div class="alert alert-danger" id="file_too_large">{{ errors['file_too_large'] }}</div>
                {% endif %}
                {% if "filesize" in errors %}
                    <div class="alert alert-danger" id="filesize">{{ errors['filesize'] }}</div>
                {% endif %}
                <div class="alert alert-danger" id="numFiles" style="display:none;">A maximum of four documents can be
                    added in one session.
                </div>
                <p>Please provide a short explanation of the record along with at least a file upload, a link to the
                    record, or instructions on how to access the record offline.</p>
                <input type="hidden" name="request_id" value="{{ req.id }}"/>
                <input type="hidden" name="audience" value="city"/>
                <fieldset>
                    <div class="row-fluid" style="width:98%;">
                        <!-- upload a record -->
                        <div class="control-group">
                            <label class="control-label">Upload a record <span
                                    id="recordTooltip" rel="tooltip"
                                    data-toggle="tooltip"
                                    data-placement="right" title=""
                                    data-original-title="{{ 'Upload a document'| explain_action }}">
                                        <small><i class="icon-info-sign"></i>
                                        </small>
                                    </span></label>

                            <div class="row-fluid" style="width:98%;" id="test_id">
                                <div class="controls">
                                    <div class="alert alert-danger" id="record_title_alert" style="display:none;">Record
                                        Title Cannot Be Longer Than 140 Characters
                                    </div>
                                               <span class="btn btn-primary fileinput-button">
                                               <i class="glyphicon glyphicon-plus"></i>
                                               <span>Add files...</span>
                                                   <!-- The file input field used as target for the file upload widget -->
                                               <input id="record" type="file" name="record" multiple>
                                                </span>
                                               <span class="btn btn-primary start" type="submit">
                                               <i class="glyphicon glyphicon-plus"></i>
                                               <span id="upload_all">Upload All</span>
                                                </span>
                                               <span class="btn btn-primary cancel" type="reset">
                                               <i class="glyphicon glyphicon-plus"></i>
                                               <span id="cancel_all">Cancel All</span>
                                                </span>
                                    <!-- The container for the uploaded files -->
                                    <div id="files" class="files"></div>
                                    <p>Size of file is limited to 10 Mb</p>
                                </div>
                            </div>
                        </div>
                        <!-- name of record -->
                        <div class="control-group">
                            <label class="control-label" for="recordSummary">Provide a name for a link to a
                                record</label>

                            {% if form %}
                                <div class="controls">
                                                <textarea class="input-xxlarge"
                                                          name="record_description"
                                                          type="text"
                                                          id="recordSummary"
                                                          placeholder="Add a short explanation of the record"
                                                          required/>{{ form['record_description'] }}</textarea>
                                </div>
                            {% else %}
                                <div class="controls">
                                    <textarea class="input-xxlarge"
                                              name="record_description"
                                              type="text"
                                              id="recordSummary"
                                              placeholder="Add a short explanation of the record"
                                              required/></textarea>
                                </div>
                            {% endif %}
                        </div>
                        <!-- link to a record -->
                        <div class="control-group">

                            {% if form %}
                                <label class="control-label">Provide the url for a link <span rel="tooltip"
                                                                                              data-toggle="tooltip"
                                                                                              data-placement="right"
                                                                                              title=""
                                                                                              data-original-title="{{ 'Add a link' |
                                        explain_action }}">
                                        <small><i class="icon-info-sign"></i>
                                        </small>
                                    </span></label>

                                <div class="row-fluid" style="width:98%;">
                                    <div class="controls">
                                        <input type="text" name="link_url" value="{{ form['link_url'] }}"
                                               id="inputUrl" class="input-xxlarge"/>

                                        <!-- need to clean this up with jquery: needs to switch from being disabled when no file exists to being enabled when a file exists -->
                                    </div>
                                </div>
                            {% else %}
                                <label class="control-label">Provide the url for a link <span rel="tooltip"
                                                                                              data-toggle="tooltip"
                                                                                              data-placement="right"
                                                                                              title=""
                                                                                              data-original-title="{{ 'Add a link' |
                                    explain_action }}">
                                    <small><i class="icon-info-sign"></i>
                                    </small>
                            </span></label>

                                <div class="row-fluid" style="width:98%;">
                                    <div class="controls">
                                        <input type="text" name="link_url"
                                               id="inputUrl" class="input-xxlarge"/>
                                        <!-- need to clean this up with jquery: needs to switch from being disabled when no file exists to being enabled when a file exists -->
                                    </div>
                                </div>
                            {% endif %}

                        </div>
                        <!-- offline record -->
                        <div class="control-group button-margin">
                            {% if form %}
                                <label class="control-label">Or indicate how the
                                    record can be accessed offline <span
                                            id="offlinedocTooltip" rel="tooltip"
                                            data-toggle="tooltip"
                                            data-placement="right"
                                            title=""
                                            data-original-title="{{ 'Describe hard copies' | explain_action }}">
                                        <small><i class="icon-info-sign"></i>
                                        </small>
                                    </span></label>

                                <div class="row-fluid" style="width:98%;">
                                    <div class="controls">
                                            <textarea class="input-xxlarge"
                                                      id="offlineDoc_textarea"
                                                      name="record_access"
                                                      placeholder="How can the requester get this record? Ex. 'Sent via mail on a CD', 'Print out awaiting requester at City Clerk desk'">{{ form['record_access'] }}</textarea>
                                    </div>
                                </div>
                            {% else %}
                                <label class="control-label">Or indicate how the
                                    record can be accessed offline <span
                                            id="offlinedocTooltip" rel="tooltip"
                                            data-toggle="tooltip"
                                            data-placement="right"
                                            title=""
                                            data-original-title="{{ 'Describe hard copies' | explain_action }}">
                                        <small><i class="icon-info-sign"></i>
                                        </small>
                                    </span></label>

                                <div class="row-fluid" style="width:98%;">
                                    <div class="controls">
                                            <textarea class="input-xxlarge"
                                                      id="offlineDoc_textarea"
                                                      name="record_access"
                                                      placeholder="How can the requester get this record? Ex. 'Sent via mail on a CD', 'Print out awaiting requester at City Clerk desk'"></textarea>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <!-- privacy -->
                        <div class="control-group">
                            <div class="controls">
                                <p>Privacy Options:</p>
                                <div class="row-fluid" style="padding-bottom: 1px; margin-bottom: 1px;">
                                    <label class="radio inline" for="release_and_public"/>
                                    <input type="radio" id="release_and_public" name="record_privacy"
                                           value="release_and_public">
                                    {# Value set to False means release and public#}
                                    Release and Public
                                </div>
                                <div class="row-fluid" style="padding-bottom: 1px; margin-bottom: 1px;">
                                    <label class="radio inline" for="release_and_private"/>
                                    <input type="radio" id="release_and_private" name="record_privacy"
                                           value="release_and_private">
                                    Released and Private
                                </div>
                                <div class="row-fluid" style="padding-bottom: 1px; margin-bottom: 1px;">
                                    <label class="radio inline" for="private"/>
                                    <input type="radio" id="private" name="record_privacy" value="private"
                                           checked="checked">
                                    Private
                                </div>
                            </div>
                        </div>
                        <!-- submission -->
                        <div class="control-group">
                            <div class="controls">
                                <button type="submit"
                                        class="btn btn-default btn-block"
                                        data-toggle="modal"
                                        data-target="#confirm-submit"
                                        id="addRecordButton">Grant Request
                                </button>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
</div>
{% endif %}
